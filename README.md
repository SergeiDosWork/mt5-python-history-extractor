# Приложение для получения исторических данных из MetaTrader 5

Данное приложение позволяет получать исторические данные по заданному тикеру из MetaTrader 5 за указанный период времени и сохранять их в формате Parquet.

## Требования к системе

- Python 3.6 или выше
- Установленный и запущенный MetaTrader 5 с активированным терминалом
- Подключение к брокеру, от которого будут получаться данные

## Установка зависимостей

### Способ 1: Установка через pip из requirements.txt

```bash
pip install -r requirements.txt
```

### Способ 2: Установка вручную

```bash
pip install MetaTrader5 pandas pyarrow
```

### Способ 3: Установка через setup.py

```bash
pip install .
```

### Установка для разработки

```bash
pip install -e .
```

## Настройка конфигурационного файла

Приложение использует файл `config.ini` для получения параметров. В файле можно указать:

- `symbol` — тикер бумаги (например, EURUSD, SBER, GAZP)
- `start_date` — начальная дата в формате YYYY-MM-DD HH:MM:SS
- `end_date` — конечная дата в формате YYYY-MM-DD HH:MM:SS
- `timeframe` — таймфрейм (по умолчанию M1 для минутного графика)

Доступные таймфреймы:
- `M1` - 1 минута
- `M2` - 2 минуты
- `M3` - 3 минуты
- `M4` - 4 минуты
- `M5` - 5 минут
- `M10` - 10 минут
- `M15` - 15 минут
- `M30` - 30 минут
- `H1` - 1 час
- `H2` - 2 часа
- `H3` - 3 часа
- `H4` - 4 часа
- `H6` - 6 часов
- `H8` - 8 часов
- `H12` - 12 часов
- `D1` - 1 день
- `W1` - 1 неделя
- `MN1` - 1 месяц

## Использование

### Базовый запуск

Запуск приложения с использованием стандартного файла конфигурации:

```bash
python mt5_history_fetcher.py
```

### Запуск с указанием параметров

Запуск с указанием конкретного файла конфигурации и имени выходного файла:

```bash
python mt5_history_fetcher.py -c my_config.ini -o my_history.parquet
```

### Параметры командной строки

- `-c`, `--config` — путь к файлу конфигурации (по умолчанию: config.ini)
- `-o`, `--output` — файл для сохранения результатов (по умолчанию: history.parquet)

## Режим совместимости

Если библиотека MetaTrader5 недоступна для установки, приложение будет работать в режиме генерации тестовых данных. Это может быть полезно для тестирования и разработки.

## Формат выходных данных

Результаты сохраняются в файл формата Parquet с расширением `.parquet`. Формат Parquet обеспечивает эффективное хранение и быструю загрузку больших объемов структурированных данных. Файл содержит таблицу с колонками:

- `time` — временная метка (строка в формате YYYY-MM-DD HH:MM:SS)
- `open` — цена открытия
- `high` — максимальная цена
- `low` — минимальная цена
- `close` — цена закрытия
- `volume` — объем торгов

## Инициализация и запуск приложения

### Шаг 1: Клонирование репозитория (если применимо)
```bash
git clone <url_репозитория>
cd <название_папки>
```

### Шаг 2: Установка зависимостей
```bash
pip install -r requirements.txt
```

### Шаг 3: Настройка конфигурации
Отредактируйте файл `config.ini`, указав:
- Тикер интересующего актива
- Диапазон дат для получения исторических данных
- Желаемый таймфрейм

### Шаг 4: Запуск MetaTrader 5
Убедитесь, что:
- MetaTrader 5 установлен и запущен
- Выполнен вход в торговый счет
- Подключение к интернету стабильно

### Шаг 5: Запуск приложения
```bash
python mt5_history_fetcher.py
```

### Шаг 6: Проверка результата
После успешного выполнения:
- В консоли будет отображена информация о процессе
- Будет создан выходной файл (по умолчанию history.parquet)
- Будет указано количество полученных баров

## Что получается в итоге работы приложения

После успешного выполнения приложения вы получите:

1. **Файл в формате Parquet** — содержащий исторические данные в структурированном виде, готовый для анализа с помощью pandas, Apache Spark и других инструментов обработки данных.

2. **Лог выполнения в консоли** — который показывает процесс получения данных, количество полученных баров и информацию о сохранении.

3. **Статистическую информацию** — количество баров, диапазон дат, использованный таймфрейм и т.д.

Пример содержимого выходного файла:
```
time                open     high     low      close    volume
2023-07-01 00:00:00 1.07543  1.07562  1.07531  1.07552  123
2023-07-01 00:01:00 1.07552  1.07571  1.07540  1.07560  98
...
```

Формат Parquet обеспечивает:
- Компактное хранение данных
- Быструю загрузку при работе с большими объемами
- Совместимость с различными инструментами анализа данных
- Сохранение типов данных столбцов